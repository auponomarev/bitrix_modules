this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,a,l,i,o,r,n,c){"use strict";let d=e=>e,b,p;class v{constructor(e){this.props=e}createListItem(e={}){const{events:s={},children:t=[]}=e;const{title:a,description:l="",modifier:i}=this.props;const o=n.Tag.render(b||(b=d`
			<span
				class="sign-blank-selector__list_item-title"
				title="${0}"
			>
				${0}
			</span>
		`),n.Text.encode(a),n.Text.encode(a));const r=n.Tag.render(p||(p=d`
			<span class="sign-blank-selector__list_item-info">
				${0}
			</span>
		`),n.Text.encode(l).replaceAll("[br]","<br />"));return n.Dom.create("div",{attrs:{className:`sign-blank-selector__list_item --${i}`},events:s,children:[...t,o,r]})}getLayout(){if(!this.layout){this.layout=this.createListItem()}return this.layout}}let h=e=>e,L;var u=babelHelpers.classPrivateFieldLooseKey("statusNode");var g=babelHelpers.classPrivateFieldLooseKey("loader");class F extends v{constructor(e){super({...e,modifier:"blank"});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,u)[u]=n.Tag.render(L||(L=h`
			<div class="sign-blank-selector__list_item-status"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,g)[g]=new c.Loader({size:30,target:babelHelpers.classPrivateFieldLooseBase(this,u)[u]})}createListItem(){return super.createListItem({children:[babelHelpers.classPrivateFieldLooseBase(this,u)[u]]})}focus(){this.getLayout().focus()}select(){n.Dom.addClass(this.layout,"--active")}deselect(e){n.Dom.removeClass(this.layout,"--active")}remove(){n.Dom.remove(this.getLayout())}set id(e){this.getLayout().dataset.id=e}set ready(e){if(!e){babelHelpers.classPrivateFieldLooseBase(this,g)[g].show();return}const s=this.getLayout();s.tabIndex="0";babelHelpers.classPrivateFieldLooseBase(this,g)[g].hide();n.Dom.addClass(s,"--loaded")}}let P=e=>e,B,H,m,_,f,y,E;const C={controller:"sign.upload.blankUploadController",acceptedFileTypes:[".jpg",".jpeg",".png",".pdf",".doc",".docx",".rtf",".odt"],multiple:true,autoUpload:false,maxFileSize:50*1024*1024,maxFileCount:100,imageMaxFileSize:10*1024*1024,maxTotalFileSize:50*1024*1024};const O={id:"qwerty",padding:20,offsetLeft:40,offsetTop:-12,angle:true,darkMode:true,width:300,autoHide:true,cacheable:false,bindOptions:{position:"bottom"}};var S=babelHelpers.classPrivateFieldLooseKey("tileWidget");var T=babelHelpers.classPrivateFieldLooseKey("tileWidgetContainer");var k=babelHelpers.classPrivateFieldLooseKey("uploadButtonsContainer");var I=babelHelpers.classPrivateFieldLooseKey("relatedTarget");var N=babelHelpers.classPrivateFieldLooseKey("edoSectionContainer");var A=babelHelpers.classPrivateFieldLooseKey("blanksContainer");var D=babelHelpers.classPrivateFieldLooseKey("notificationContainer");var K=babelHelpers.classPrivateFieldLooseKey("page");var w=babelHelpers.classPrivateFieldLooseKey("loadMoreButton");var R=babelHelpers.classPrivateFieldLooseKey("api");var j=babelHelpers.classPrivateFieldLooseKey("config");var U=babelHelpers.classPrivateFieldLooseKey("changeDomainWarningContainer");var M=babelHelpers.classPrivateFieldLooseKey("checkForFilesValid");var $=babelHelpers.classPrivateFieldLooseKey("onFileBeforeAdd");var x=babelHelpers.classPrivateFieldLooseKey("getImagesLimit");var X=babelHelpers.classPrivateFieldLooseKey("onFileAdd");var G=babelHelpers.classPrivateFieldLooseKey("onFileRemove");var W=babelHelpers.classPrivateFieldLooseKey("onUploadStart");var z=babelHelpers.classPrivateFieldLooseKey("toggleTileVisibility");var V=babelHelpers.classPrivateFieldLooseKey("createUploadButtons");var q=babelHelpers.classPrivateFieldLooseKey("resumeUploading");var Y=babelHelpers.classPrivateFieldLooseKey("loadBlanks");var J=babelHelpers.classPrivateFieldLooseKey("setupBlank");var Q=babelHelpers.classPrivateFieldLooseKey("appendUnsecuredSchemeWarningContainer");var Z=babelHelpers.classPrivateFieldLooseKey("appendChangeDomainWarningContainer");var ee=babelHelpers.classPrivateFieldLooseKey("getWarning");var se=babelHelpers.classPrivateFieldLooseKey("removeChangeDomainWarningContainer");var te=babelHelpers.classPrivateFieldLooseKey("appendEdoWarningContainer");class ae extends t.EventEmitter{constructor(e){super();Object.defineProperty(this,te,{value:Pe});Object.defineProperty(this,se,{value:Fe});Object.defineProperty(this,ee,{value:ge});Object.defineProperty(this,Z,{value:ue});Object.defineProperty(this,Q,{value:Le});Object.defineProperty(this,J,{value:he});Object.defineProperty(this,Y,{value:ve});Object.defineProperty(this,q,{value:pe});Object.defineProperty(this,V,{value:be});Object.defineProperty(this,z,{value:de});Object.defineProperty(this,W,{value:ce});Object.defineProperty(this,G,{value:ne});Object.defineProperty(this,X,{value:re});Object.defineProperty(this,x,{value:oe});Object.defineProperty(this,$,{value:ie});Object.defineProperty(this,M,{value:le});Object.defineProperty(this,S,{writable:true,value:void 0});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,D,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,U,{writable:true,value:void 0});this.setEventNamespace("BX.Sign.V2.BlankSelector");this.subscribeFromOptions(e==null?void 0:e.events);babelHelpers.classPrivateFieldLooseBase(this,j)[j]=e;this.selectedBlankId=0;this.blanks=new Map;babelHelpers.classPrivateFieldLooseBase(this,K)[K]=0;const s=babelHelpers.classPrivateFieldLooseBase(this,V)[V]();const t=n.Tag.render(B||(B=P`
			<label class="sign-blank-selector__list_drag-area-label">
				${0}
			</label>
		`),n.Loc.getMessage("SIGN_BLANK_SELECTOR_DRAG_AREA"));const a={slots:{afterDropArea:{computed:{title:()=>n.Loc.getMessage("SIGN_BLANK_SELECTOR_CLEAR_ALL")},methods:{clear:()=>{this.clearFiles({removeFromServer:false})}},template:`\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="sign-blank-selector__tile-widget_clear-btn"\n\t\t\t\t\t\t\t:title="title"\n\t\t\t\t\t\t\t@click="clear()"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`}}};babelHelpers.classPrivateFieldLooseBase(this,k)[k]=n.Tag.render(H||(H=P`
			<div class="sign-blank-selector__list --with-buttons">
				${0}
				${0}
			</div>
		`),s,t);babelHelpers.classPrivateFieldLooseBase(this,S)[S]=new l.TileWidget({...C,...e.uploaderOptions,dropElement:babelHelpers.classPrivateFieldLooseBase(this,k)[k],browseElement:[...s,t],events:{[i.UploaderEvent.BEFORE_FILES_ADD]:e=>babelHelpers.classPrivateFieldLooseBase(this,$)[$](e),[i.UploaderEvent.FILE_ADD]:e=>babelHelpers.classPrivateFieldLooseBase(this,X)[X](e),[i.UploaderEvent.FILE_REMOVE]:e=>babelHelpers.classPrivateFieldLooseBase(this,G)[G](e),[i.UploaderEvent.UPLOAD_START]:e=>babelHelpers.classPrivateFieldLooseBase(this,W)[W](e)}},a);babelHelpers.classPrivateFieldLooseBase(this,I)[I]=null;n.Event.bind(document,"mousedown",(e=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]=e.target}));babelHelpers.classPrivateFieldLooseBase(this,A)[A]=n.Tag.render(m||(m=P`
			<div
				class="sign-blank-selector__list"
				onfocusin="${0}"
				onfocusout="${0}"
			></div>
		`),(({target:e})=>{this.selectBlank(Number(e.dataset.id))}),(({target:e})=>{this.resetSelectedBlank(Number(e.dataset.id),babelHelpers.classPrivateFieldLooseBase(this,I)[I])}));babelHelpers.classPrivateFieldLooseBase(this,T)[T]=n.Tag.render(_||(_=P`
			<div class="sign-blank-selector__tile-widget"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,w)[w]=n.Tag.render(f||(f=P`
			<button
				class="ui-btn ui-btn-light-border sign-blank-selector__load-more-btn --hidden"
				onclick="${0}"
			>
				${0}
			</button>
		`),(()=>babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](babelHelpers.classPrivateFieldLooseBase(this,K)[K]+1)),n.Loc.getMessage("SIGN_BLANK_SELECTOR_LOAD_MORE"));babelHelpers.classPrivateFieldLooseBase(this,D)[D]=n.Tag.render(y||(y=P`<div></div>`));if(babelHelpers.classPrivateFieldLooseBase(this,j)[j].portalConfig.isDomainChanged){babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]()}if(babelHelpers.classPrivateFieldLooseBase(this,j)[j].portalConfig.isUnsecuredScheme){babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()}if(babelHelpers.classPrivateFieldLooseBase(this,j)[j].portalConfig.isEdoRegion){babelHelpers.classPrivateFieldLooseBase(this,te)[te]()}babelHelpers.classPrivateFieldLooseBase(this,R)[R]=new o.Api}async createBlank(){const e=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();const s=e.getFiles();const[t]=s;await babelHelpers.classPrivateFieldLooseBase(this,q)[q]();const a=t.getCustomData(t.getId());try{var l;const e=s.map((e=>e.getServerFileId()));const t=await babelHelpers.classPrivateFieldLooseBase(this,R)[R].createBlank(e,(l=babelHelpers.classPrivateFieldLooseBase(this,j)[j].type)!=null?l:null);const i=t.id;babelHelpers.classPrivateFieldLooseBase(this,J)[J](i,a);return i}catch(e){a.remove();throw e}}resetSelectedBlank(e,s){const t=this.blanks.get(this.selectedBlankId);this.selectedBlankId=0;t==null?void 0:t.deselect();this.emit("toggleSelection",{blankId:e,relatedTarget:s,selected:false})}selectBlank(e){if(e!==this.selectedBlankId){this.resetSelectedBlank()}this.selectedBlankId=e;babelHelpers.classPrivateFieldLooseBase(this,z)[z](false);const s=this.blanks.get(e);s.select();this.emit("toggleSelection",{selected:true})}deleteBlank(e){const s=this.blanks.get(e);if(s){this.blanks.delete(e);s.remove()}this.selectedBlankId=0}clearFiles(e){const s=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();s.removeFiles(e)}isFilesReadyForUpload(){if(babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader().getFiles().length===0){return false}return babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader().getFiles().every((e=>e.getErrors().length<=0))}getLayout(){babelHelpers.classPrivateFieldLooseBase(this,S)[S].renderTo(babelHelpers.classPrivateFieldLooseBase(this,T)[T]);babelHelpers.classPrivateFieldLooseBase(this,z)[z](false);const e=n.Tag.render(E||(E=P`
			<div class="sign-blank-selector">
				<p class="sign-blank-selector__add-title">
					${0}
				</p>
				${0}
				${0}
				${0}
				${0}
				<p class="sign-blank-selector__templates_title">
					${0}
				</p>
				${0}
				${0}
			</div>
		`),n.Loc.getMessage("SIGN_BLANK_SELECTOR_ADD_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,N)[N],babelHelpers.classPrivateFieldLooseBase(this,T)[T],babelHelpers.classPrivateFieldLooseBase(this,D)[D],babelHelpers.classPrivateFieldLooseBase(this,k)[k],n.Loc.getMessage("SIGN_BLANK_SELECTOR_RECENT_TEMPLATES_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,A)[A],babelHelpers.classPrivateFieldLooseBase(this,w)[w]);if(babelHelpers.classPrivateFieldLooseBase(this,K)[K]===0){babelHelpers.classPrivateFieldLooseBase(this,Y)[Y](1)}return e}}function le(e){const s=e=>e.getType().includes("image/");const t=e.every((e=>s(e)));const a=e.every((e=>C.acceptedFileTypes.includes(`.${e.getExtension()}`)));if(!a||e.length>1&&!t){return false}const l=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();const i=l.getFiles();const o=i.length;const r=babelHelpers.classPrivateFieldLooseBase(this,x)[x]();if(o===0&&e.length===1){return true}const n=i.every((e=>s(e)));return t&&n&&r-o>=e.length}function ie(e){const{files:t}=e.getData();const a=babelHelpers.classPrivateFieldLooseBase(this,M)[M](t);if(a){return}let l=babelHelpers.classPrivateFieldLooseBase(this,k)[k].firstElementChild;if(n.Dom.hasClass(babelHelpers.classPrivateFieldLooseBase(this,k)[k],"--hidden")){const{$refs:{container:e}}=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getRootComponent();l=e.firstElementChild}const i=new s.Popup({...O,bindElement:l,content:n.Loc.getMessage("SIGN_BLANK_SELECTOR_UPLOAD_HINT",{"%imageCountLimit%":babelHelpers.classPrivateFieldLooseBase(this,x)[x]()})});i.show();e.preventDefault()}function oe(){var e,s,t,a;return n.Type.isInteger(parseInt((e=babelHelpers.classPrivateFieldLooseBase(this,j)[j])==null?void 0:(s=e.uploaderOptions)==null?void 0:s.maxFileCount,10))?(t=babelHelpers.classPrivateFieldLooseBase(this,j)[j])==null?void 0:(a=t.uploaderOptions)==null?void 0:a.maxFileCount:C.maxFileCount}function re(){babelHelpers.classPrivateFieldLooseBase(this,z)[z](true);this.emit("addFile")}function ne(e){this.emit("removeFile");const s=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();const t=s.getFiles();if(t.length===0){babelHelpers.classPrivateFieldLooseBase(this,z)[z](false);this.emit("clearFiles")}}function ce(){const e=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();const[s]=e.getFiles();const t=s.getName();const a=s.getId();const l=new F({title:t});l.ready=false;n.Dom.prepend(l.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,A)[A]);s.setCustomData(a,l)}function de(e){const s="--hidden";if(e){n.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,T)[T],s);n.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,k)[k],s);return}n.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,T)[T],s);n.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,k)[k],s)}function be(){const e={img:{title:n.Loc.getMessage("SIGN_BLANK_SELECTOR_CREATE_NEW_PIC"),description:"jpeg, png"},pdf:{title:n.Loc.getMessage("SIGN_BLANK_SELECTOR_NEW_PDF"),description:"Adobe Acrobat"},doc:{title:n.Loc.getMessage("SIGN_BLANK_SELECTOR_NEW_DOC"),description:"doc, docx"}};const s=Object.entries(e);return s.map((([e,{title:s,description:t}])=>new v({title:s,description:t,modifier:e}).getLayout()))}async function pe(){const e=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getUploader();const s=e.getFiles();e.setMaxParallelUploads(s.length);const t=new Promise((s=>{e.subscribeOnce("onUploadComplete",s)}));e.start();await t}async function ve(e){const s=new c.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,A)[A],size:80,mode:"custom"});s.show();try{var t;const s=await babelHelpers.classPrivateFieldLooseBase(this,R)[R].loadBlanks(e,(t=babelHelpers.classPrivateFieldLooseBase(this,j)[j].type)!=null?t:null);const a=10;if(s.length<a){n.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,w)[w],"--hidden")}else{n.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,w)[w],"--hidden")}if(s.length>0){s.forEach((({title:e,id:s})=>{const t=new F({title:e});babelHelpers.classPrivateFieldLooseBase(this,J)[J](s,t);n.Dom.append(t.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,A)[A])}));babelHelpers.classPrivateFieldLooseBase(this,K)[K]=e}}catch(e){n.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,w)[w],"--hidden")}s.destroy()}function he(e,s){s.id=e;s.ready=true;this.blanks.set(e,s)}function Le(){const e=`<div>${n.Loc.getMessage("SIGN_BLANK_SELECTOR_USE_UNSECURED_SCHEME_WARNING")}</div>`;const s=babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]();s.setText(e);n.Dom.append(s.getContainer(),babelHelpers.classPrivateFieldLooseBase(this,D)[D])}function ue(){const e=new a.Button({text:n.Loc.getMessage("SIGN_BLANK_SELECTOR_REFRESH_DOMAIN_BUTTON_TEXT"),color:a.Button.Color.LINK,onclick:()=>babelHelpers.classPrivateFieldLooseBase(this,R)[R].changeDomain().then((()=>babelHelpers.classPrivateFieldLooseBase(this,se)[se]())),className:"sign-blank-selector__change_domain_button",size:a.Button.Size.EXTRA_SMALL});const s=`<p>${n.Loc.getMessage("SIGN_BLANK_SELECTOR_CHANGE_DOMAIN_WARNING")}</p>`;const t=babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]();t.setText(s);babelHelpers.classPrivateFieldLooseBase(this,U)[U]=t.getContainer();n.Dom.append(e.getContainer(),babelHelpers.classPrivateFieldLooseBase(this,U)[U]);n.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,U)[U],babelHelpers.classPrivateFieldLooseBase(this,D)[D])}function ge(){return new r.Alert({size:r.Alert.Size.MD,color:r.Alert.Color.WARNING,icon:r.Alert.Icon.DANGER,customClass:"sign-blank-selector__change_domain_wrapper"})}function Fe(){n.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,U)[U])}function Pe(){const e=n.Loc.getMessage("SIGN_BLANK_SELECTOR_EDO_TEXT",{"[helpdesklink]":'<a class="sign-blank-selector__edo-block_helpdesk-article" href="javascript:top.BX.Helper.show(\'redirect=detail&code=18453372\');">',"[/helpdesklink]":"</a>"});const s=babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]();s.setColor(r.Alert.Color.PRIMARY);s.setIcon(r.Alert.Icon.INFO);s.setText(e);n.Dom.append(s.getContainer(),babelHelpers.classPrivateFieldLooseBase(this,D)[D])}e.BlankSelector=ae})(this.BX.Sign.V2=this.BX.Sign.V2||{},BX.Main,BX.Event,BX.UI,BX.UI.Uploader,BX.UI.Uploader,BX.Sign.V2,BX.UI,BX,BX);
//# sourceMappingURL=blank-selector.bundle.map.js